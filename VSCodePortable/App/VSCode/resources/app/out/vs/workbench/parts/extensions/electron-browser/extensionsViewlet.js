/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
(function(){var e=["require","vs/base/common/event","exports","vs/workbench/parts/extensions/electron-browser/extensionsList","vs/base/browser/dom","vs/base/common/lifecycle","vs/base/browser/ui/list/listPaging","vs/platform/instantiation/common/instantiation","vs/platform/message/common/message","vs/base/browser/event","vs/workbench/parts/extensions/electron-browser/extensionsActions","vs/base/browser/ui/actionbar/actionbar","vs/base/browser/ui/list/listWidget","vs/css!vs/workbench/parts/extensions/electron-browser/media/extensionsViewlet","vs/css!vs/base/browser/ui/list/list","vs/workbench/parts/extensions/electron-browser/extensionsWidgets","vs/base/common/events","vs/workbench/parts/extensions/electron-browser/extensionsViewlet","vs/nls!vs/workbench/parts/extensions/electron-browser/extensionsViewlet","vs/base/common/async","vs/base/common/arrays","vs/base/common/errors","vs/base/common/objects","vs/base/browser/keyboardEvent","vs/base/common/keyCodes","vs/workbench/browser/viewlet","vs/workbench/services/viewlet/common/viewletService","vs/base/common/paging","vs/platform/telemetry/common/telemetry","vs/workbench/parts/extensions/electron-browser/extensions","vs/platform/extensionManagement/common/extensionManagement","vs/workbench/parts/extensions/electron-browser/extensionsInput","vs/workbench/parts/extensions/common/extensionQuery","vs/workbench/browser/actions/openSettings","vs/platform/progress/common/progress","vs/workbench/services/editor/common/editorService","vs/workbench/services/group/common/groupService","vs/base/common/severity","vs/platform/url/common/url","vs/base/common/winjs.base"],t=function(t){for(var n=[],s=0,o=t.length;s<o;s++)n[s]=e[t[s]];return n};define(e[6],t([0,2,20,12,1,14]),function(e,t,n,s,o){"use strict";var i=function(){function e(e,t){this.renderer=e,this.modelProvider=t}return Object.defineProperty(e.prototype,"templateId",{get:function(){return this.renderer.templateId},enumerable:!0,configurable:!0}),e.prototype.renderTemplate=function(e){var t=this.renderer.renderTemplate(e);return{data:t,disposable:{dispose:function(){}}}},e.prototype.renderElement=function(e,t,n){var s=this;n.disposable.dispose();var o=this.modelProvider();if(o.isResolved(e))return this.renderer.renderElement(o.get(e),e,n.data);var i=o.resolve(e);n.disposable={dispose:function(){return i.cancel()}},this.renderer.renderPlaceholder(e,n.data),i.done(function(t){return s.renderer.renderElement(t,e,n.data)})},e.prototype.disposeTemplate=function(e){e.disposable.dispose(),e.disposable=null,this.renderer.disposeTemplate(e.data),e.data=null},e}(),r=function(){function e(e,t,n){var o=this,r=n.map(function(e){return new i(e,function(){return o.model})});this.list=new s.List(e,t,r)}return Object.defineProperty(e.prototype,"onDOMFocus",{get:function(){return this.list.onDOMFocus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onFocusChange",{get:function(){var e=this;return o.mapEvent(this.list.onFocusChange,function(t){var n=t.elements,s=t.indexes;return{elements:n.map(function(t){return e._model.get(t)}),indexes:s}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onSelectionChange",{get:function(){var e=this;return o.mapEvent(this.list.onSelectionChange,function(t){var n=t.elements,s=t.indexes;return{elements:n.map(function(t){return e._model.get(t)}),indexes:s}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},set:function(e){this._model=e,(t=this.list).splice.apply(t,[0,this.list.length].concat(n.range(e.length)));var t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollTop",{get:function(){return this.list.scrollTop},set:function(e){this.list.scrollTop=e},enumerable:!0,configurable:!0}),e.prototype.focusNext=function(e,t){this.list.focusNext(e,t)},e.prototype.focusPrevious=function(e,t){this.list.focusPrevious(e,t)},e.prototype.selectNext=function(e,t){this.list.selectNext(e,t)},e.prototype.selectPrevious=function(e,t){this.list.selectPrevious(e,t)},e.prototype.focusNextPage=function(){this.list.focusNextPage()},e.prototype.focusPreviousPage=function(){this.list.focusPreviousPage()},e.prototype.getFocus=function(){return this.list.getFocus()},e.prototype.setSelection=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];(n=this.list).setSelection.apply(n,e);var n},e.prototype.layout=function(e){this.list.layout(e)},e.prototype.reveal=function(e,t){this.list.reveal(e,t)},e}();t.PagedList=r});var n=this&&this.__decorate||function(e,t,n,s){var o,i=arguments.length,r=i<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(i<3?o(r):i>3?o(t,n,r):o(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__param||function(e,t){return function(n,s){t(n,s,e)}};define(e[3],t([0,2,4,5,11,7,8,1,9,10,15,16]),function(e,t,o,i,r,a,c,l,p,u,h,d){"use strict";var v=function(){function e(){}return e.prototype.getHeight=function(){return 62},e.prototype.getTemplateId=function(){return"extension"},e}();t.Delegate=v;var f={icon:!0,label:!0},m=function(){function e(e,t){this.instantiationService=e,this.messageService=t}return Object.defineProperty(e.prototype,"templateId",{get:function(){return"extension"},enumerable:!0,configurable:!0}),e.prototype.renderTemplate=function(e){var t=this,n=o.append(e,o.$(".extension")),s=o.append(n,o.$("img.icon")),i=o.append(n,o.$(".details")),a=o.append(i,o.$(".header")),l=o.append(a,o.$("span.name")),p=o.append(a,o.$("span.version")),v=o.append(a,o.$("span.install-count")),m=o.append(a,o.$("span.ratings")),g=o.append(i,o.$(".description.ellipsis")),y=o.append(i,o.$(".footer")),b=o.append(y,o.$(".author.ellipsis")),x=new r.ActionBar(y,{animated:!1});x.addListener2(d.EventType.RUN,function(e){var n=e.error;return n&&t.messageService.show(c.Severity.Error,n)});var S=this.instantiationService.createInstance(h.Label,p,function(e){return e.version}),w=this.instantiationService.createInstance(h.InstallWidget,v,{small:!0}),E=this.instantiationService.createInstance(h.RatingsWidget,m,{small:!0}),I=this.instantiationService.createInstance(u.CombinedInstallAction),A=this.instantiationService.createInstance(u.UpdateAction),C=this.instantiationService.createInstance(u.EnableAction);x.push([C,A,I],f);var P=[S,w,E,I,A,C,x];return{element:n,icon:s,name:l,installCount:v,ratings:m,author:b,description:g,disposables:P,extensionDisposables:[],set extension(e){S.extension=e,w.extension=e,E.extension=e,I.extension=e,A.extension=e,C.extension=e}}},e.prototype.renderPlaceholder=function(e,t){o.addClass(t.element,"loading"),t.extensionDisposables=i.dispose(t.extensionDisposables),t.icon.src="",t.name.textContent="",t.author.textContent="",t.description.textContent="",t.installCount.style.display="none",t.ratings.style.display="none",t.extension=null},e.prototype.renderElement=function(e,t,n){o.removeClass(n.element,"loading"),n.extensionDisposables=i.dispose(n.extensionDisposables);var s=l.once(p.domEvent(n.icon,"error"));s(function(){return n.icon.src=e.iconUrlFallback},null,n.extensionDisposables),n.icon.src=e.iconUrl,n.icon.complete?n.icon.style.visibility="inherit":(n.icon.style.visibility="hidden",n.icon.onload=function(){return n.icon.style.visibility="inherit"}),n.name.textContent=e.displayName,n.author.textContent=e.publisherDisplayName,n.description.textContent=e.description,n.installCount.style.display="",n.ratings.style.display="",n.extension=e},e.prototype.disposeTemplate=function(e){e.disposables=i.dispose(e.disposables)},e=n([s(0,a.IInstantiationService),s(1,c.IMessageService)],e)}();t.Renderer=m});var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};define(e[17],t([0,2,18,19,39,21,5,22,1,9,11,23,24,25,26,4,27,28,6,7,3,29,10,30,31,32,33,34,35,36,8,37,38,13]),function(e,t,i,r,a,c,l,p,u,h,d,v,f,m,g,y,b,x,S,w,E,I,A,C,P,O,k,D,L,B,T,U,R){"use strict";var j=function(e){function t(t,n,s,o,i,a,c,l,p,h,d,v){e.call(this,I.VIEWLET_ID,t),this.galleryService=n,this.extensionService=s,this.progressService=o,this.instantiationService=i,this.editorService=a,this.editorInputService=c,this.extensionsWorkbenchService=l,this.tipsService=h,this.messageService=d,this.viewletService=v,this.disposables=[],this.searchDelayer=new r.ThrottledDelayer(500);var f=u.filterEvent(p.onOpenURL,function(e){return/^extension/.test(e.path)});f(this.onOpenExtensionUrl,this,this.disposables),this.disposables.push(v.onDidViewletOpen(this.onViewletOpen,this,this.disposables))}return o(t,e),t.prototype.create=function(t){var n=this;e.prototype.create.call(this,t),t.addClass("extensions-viewlet"),this.root=t.getHTMLElement();var s=y.append(this.root,y.$(".header"));this.searchBox=y.append(s,y.$("input.search-box")),this.searchBox.placeholder=i.localize(0,null),this.disposables.push(y.addStandardDisposableListener(this.searchBox,y.EventType.FOCUS,function(){return y.addClass(n.searchBox,"synthetic-focus")})),this.disposables.push(y.addStandardDisposableListener(this.searchBox,y.EventType.BLUR,function(){return y.removeClass(n.searchBox,"synthetic-focus")})),this.extensionsBox=y.append(this.root,y.$(".extensions"));var o=new E.Delegate,r=this.instantiationService.createInstance(E.Renderer);this.list=new S.PagedList(this.extensionsBox,o,[r]);var c=h.domEvent(this.searchBox,"keydown"),l=u.mapEvent(c,function(e){return new v.StandardKeyboardEvent(e)}),p=u.filterEvent(l,function(e){return e.keyCode===f.KeyCode.Enter}),d=u.filterEvent(l,function(e){return e.keyCode===f.KeyCode.Escape}),m=u.filterEvent(l,function(e){return e.keyCode===f.KeyCode.UpArrow}),g=u.filterEvent(l,function(e){return e.keyCode===f.KeyCode.DownArrow}),b=u.filterEvent(l,function(e){return e.keyCode===f.KeyCode.PageUp}),x=u.filterEvent(l,function(e){return e.keyCode===f.KeyCode.PageDown});p(this.onEnter,this,this.disposables),d(this.onEscape,this,this.disposables),m(this.onUpArrow,this,this.disposables),g(this.onDownArrow,this,this.disposables),b(this.onPageUpArrow,this,this.disposables),x(this.onPageDownArrow,this,this.disposables);var w=h.domEvent(this.searchBox,"input");w(function(e){return n.triggerSearch(e.target.value,e.immediate)},null,this.disposables),this.onSearchChange=u.mapEvent(w,function(e){return e.target.value});var I=u.filterEvent(u.mapEvent(this.list.onSelectionChange,function(e){return e.elements[0]}),function(e){return!!e});return I(this.openExtension,this,this.disposables),a.TPromise.as(null)},t.prototype.setVisible=function(t){var n=this;return e.prototype.setVisible.call(this,t).then(function(){t?(n.searchBox.focus(),n.searchBox.setSelectionRange(0,n.searchBox.value.length),n.triggerSearch(n.searchBox.value,!0,!0)):n.list.model=new b.PagedModel([])})},t.prototype.focus=function(){this.searchBox.focus()},t.prototype.layout=function(e){var t=e.height,n=e.width;this.list.layout(t-38),y.toggleClass(this.root,"narrow",n<=300)},t.prototype.getOptimalWidth=function(){return 400},t.prototype.getActions=function(){return this.primaryActions||(this.primaryActions=[this.instantiationService.createInstance(A.ClearExtensionsInputAction,A.ClearExtensionsInputAction.ID,A.ClearExtensionsInputAction.LABEL,this.onSearchChange)]),this.primaryActions},t.prototype.getSecondaryActions=function(){return this.secondaryActions||(this.secondaryActions=[this.instantiationService.createInstance(A.UpdateAllAction,A.UpdateAllAction.ID,A.UpdateAllAction.LABEL),new d.Separator,this.instantiationService.createInstance(A.ShowInstalledExtensionsAction,A.ShowInstalledExtensionsAction.ID,A.ShowInstalledExtensionsAction.LABEL),this.instantiationService.createInstance(A.ShowOutdatedExtensionsAction,A.ShowOutdatedExtensionsAction.ID,A.ShowOutdatedExtensionsAction.LABEL),this.instantiationService.createInstance(A.ShowRecommendedExtensionsAction,A.ShowRecommendedExtensionsAction.ID,A.ShowRecommendedExtensionsAction.LABEL),this.instantiationService.createInstance(A.ShowPopularExtensionsAction,A.ShowPopularExtensionsAction.ID,A.ShowPopularExtensionsAction.LABEL),new d.Separator,this.instantiationService.createInstance(A.ChangeSortAction,"extensions.sort.install",i.localize(1,null),this.onSearchChange,"installs",void 0),this.instantiationService.createInstance(A.ChangeSortAction,"extensions.sort.rating",i.localize(2,null),this.onSearchChange,"rating",void 0),new d.Separator,this.instantiationService.createInstance(A.ChangeSortAction,"extensions.sort..asc",i.localize(3,null),this.onSearchChange,void 0,"asc"),this.instantiationService.createInstance(A.ChangeSortAction,"extensions.sort..desc",i.localize(4,null),this.onSearchChange,void 0,"desc")]),this.secondaryActions},t.prototype.search=function(e){var t=new Event("input",{bubbles:!0});t.immediate=!0,this.searchBox.value=e,this.searchBox.dispatchEvent(t)},t.prototype.triggerSearch=function(e,t,n){var s=this;void 0===t&&(t=!1),void 0===n&&(n=!1),this.searchDelayer.trigger(function(){return s.doSearch(e,n)},t||!e?0:500).done(null,function(e){return s.onError(e)})},t.prototype.doSearch=function(e,t){var n=this;return void 0===e&&(e=""),void 0===t&&(t=!1),this.progress(this.query(e)).then(function(s){return!e&&0===s.length&&t?n.search("@sort:installs"):(n.list.model=s,void(n.list.scrollTop=0))})},t.prototype.query=function(e){var t=this;if(!e||/@outdated/i.test(e)){var n=this.extensionsWorkbenchService.queryLocal();return/@outdated/i.test(e)&&(n=n.then(function(e){return e.filter(function(e){return e.outdated})})),n.then(function(e){return new b.PagedModel(e)})}var s=O.Query.parse(e),o={};switch(s.sortBy){case"installs":o=p.assign(o,{sortBy:C.SortBy.InstallCount});break;case"rating":o=p.assign(o,{sortBy:C.SortBy.AverageRating})}switch(s.sortOrder){case"asc":o=p.assign(o,{sortOrder:C.SortOrder.Ascending});break;case"desc":o=p.assign(o,{sortOrder:C.SortOrder.Descending})}if(/@recommended/i.test(s.value)){var i=s.value.replace(/@recommended/g,"").trim().toLowerCase();return this.extensionsWorkbenchService.queryLocal().then(function(e){var n=t.tipsService.getRecommendations().filter(function(t){return e.every(function(e){return e.publisher+"."+e.name!==t})}).filter(function(e){return e.toLowerCase().indexOf(i)>-1});return t.telemetryService.publicLog("extensionRecommendations:open",{count:n.length}),n.length?t.extensionsWorkbenchService.queryGallery(p.assign(o,{names:n,pageSize:n.length})).then(function(e){return new b.PagedModel(e)}):new b.PagedModel([])})}return s.value&&(o=p.assign(o,{text:s.value.substr(0,200)})),this.extensionsWorkbenchService.queryGallery(o).then(function(e){return new b.PagedModel(e)})},t.prototype.openExtension=function(e){var t=this;this.editorService.openEditor(this.instantiationService.createInstance(P.ExtensionsInput,e)).done(null,function(e){return t.onError(e)})},t.prototype.onEnter=function(){(e=this.list).setSelection.apply(e,this.list.getFocus());var e},t.prototype.onEscape=function(){this.search("")},t.prototype.onUpArrow=function(){this.list.focusPrevious(),this.list.reveal(this.list.getFocus()[0])},t.prototype.onDownArrow=function(){this.list.focusNext(),this.list.reveal(this.list.getFocus()[0])},t.prototype.onPageUpArrow=function(){this.list.focusPreviousPage(),this.list.reveal(this.list.getFocus()[0])},t.prototype.onPageDownArrow=function(){this.list.focusNextPage(),this.list.reveal(this.list.getFocus()[0])},t.prototype.onOpenExtensionUrl=function(e){var t=this,n=/^extension\/([^\/]+)$/.exec(e.path);if(n){var s=n[1];this.extensionsWorkbenchService.queryGallery({names:[s]}).done(function(e){if(!(e.total<1)){var n=e.firstPage[0];t.openExtension(n)}})}},t.prototype.progress=function(e){var t=this.progressService.show(!0);return r.always(e,function(){return t.done()})},t.prototype.onViewletOpen=function(e){var t=this;if(e&&e.getId()!==I.VIEWLET_ID){var n=this.editorInputService.getStacksModel(),s=n.groups.map(function(e){var s=n.positionOfGroup(e),o=e.getEditors().filter(function(e){return e instanceof P.ExtensionsInput}),i=o.map(function(e){return t.editorService.closeEditor(s,e)});return a.TPromise.join(i)});a.TPromise.join(s).done(null,c.onUnexpectedError)}},t.prototype.onError=function(e){if(!c.isPromiseCanceledError(e)){var t=e&&e.message||"";if(!/ECONNREFUSED/.test(t)){var n=c.create(i.localize(5,null),{actions:[T.CloseAction,this.instantiationService.createInstance(k.OpenGlobalSettingsAction,k.OpenGlobalSettingsAction.ID,k.OpenGlobalSettingsAction.LABEL)]});return void this.messageService.show(U["default"].Error,n)}this.messageService.show(U["default"].Error,e)}},t.prototype.dispose=function(){this.disposables=l.dispose(this.disposables),e.prototype.dispose.call(this)},t=n([s(0,x.ITelemetryService),s(1,C.IExtensionGalleryService),s(2,C.IExtensionManagementService),s(3,D.IProgressService),s(4,w.IInstantiationService),s(5,L.IWorkbenchEditorService),s(6,B.IEditorGroupService),s(7,I.IExtensionsWorkbenchService),s(8,R.IURLService),s(9,C.IExtensionTipsService),s(10,T.IMessageService),s(11,g.IViewletService)],t)}(m.Viewlet);t.ExtensionsViewlet=j})}).call(this);
//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/66f37fd2a99eb9d628dd374d81d78835b410c39b/vs\workbench\parts\extensions\electron-browser\extensionsViewlet.js.map
