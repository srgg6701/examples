/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
(function(){var e=["require","exports","vs/platform/configuration/common/configuration","vs/workbench/browser/quickopen","vs/nls!vs/workbench/parts/search/browser/openAnythingHandler","vs/base/common/objects","vs/base/common/winjs.base","vs/base/parts/quickopen/browser/quickOpenModel","vs/platform/workspace/common/workspace","vs/platform/instantiation/common/instantiation","vs/workbench/parts/search/browser/openFileHandler","vs/nls!vs/workbench/parts/search/browser/openSymbolHandler","vs/base/common/errors","vs/base/common/paths","vs/base/common/labels","vs/base/common/async","vs/workbench/parts/search/common/searchQuery","vs/nls","vs/workbench/parts/search/browser/openSymbolHandler","vs/platform/search/common/search","vs/workbench/services/editor/common/editorService","vs/nls!vs/workbench/parts/search/browser/openFileHandler","vs/workbench/parts/search/browser/openAnythingHandler","vs/workbench/services/group/common/groupService","vs/base/common/uuid","vs/base/common/filters","vs/editor/common/core/range","vs/workbench/parts/search/common/search","vs/workbench/common/editor","vs/base/common/arrays","vs/base/common/types","vs/base/common/platform","vs/base/common/strings","vs/platform/message/common/message","vs/platform/telemetry/common/telemetry"],t=function(t){for(var r=[],n=0,o=t.length;n<o;n++)r[n]=e[t[n]];return r};define(e[21],t([17,4]),function(e,t){return e.create("vs/workbench/parts/search/browser/openFileHandler",t)}),define(e[11],t([17,4]),function(e,t){return e.create("vs/workbench/parts/search/browser/openSymbolHandler",t)});var r=this&&this.__decorate||function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};define(e[16],t([0,1,5,19,2]),function(e,t,o,i,s){"use strict";function c(e){var t=e&&e.files&&e.files.exclude,r=e&&e.search&&e.search.exclude;if(!t&&!r)return null;if(!t||!r)return t||r;var n=Object.create(null);return n=o.mixin(n,t),n=o.mixin(n,r,!0)}t.getExcludes=c;var a=function(){function e(e){this.configurationService=e}return e.prototype.text=function(e,t){return this.query(i.QueryType.Text,e,t)},e.prototype.file=function(e){return this.query(i.QueryType.File,null,e)},e.prototype.query=function(e,t,r){void 0===r&&(r={});var n=this.configurationService.getConfiguration(),i=c(n);return r.excludePattern?o.mixin(r.excludePattern,i,!1):r.excludePattern=i,{type:e,folderResources:r.folderResources,extraFileResources:r.extraFileResources,filePattern:r.filePattern,excludePattern:r.excludePattern,includePattern:r.includePattern,maxResults:r.maxResults,sortByScore:r.sortByScore,cacheKey:r.cacheKey,fileEncoding:r.fileEncoding,contentPattern:t}},e=r([n(0,s.IConfigurationService)],e)}();t.QueryBuilder=a});var o=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};define(e[10],t([0,1,6,12,21,13,14,5,24,7,3,16,28,23,20,2,9,19,8]),function(e,t,i,s,c,a,u,l,h,p,d,f,m,v,y,g,S,b,k){"use strict";var R=function(e){function t(t,r){e.call(this,t),this.stats=r}return o(t,e),t}(p.QuickOpenModel);t.FileQuickOpenModel=R;var L=function(e){function t(t,r,n,o,i,s,c,a){e.call(this,i),this.resource=t,this.name=r,this.description=n,this.icon=o,this.instantiationService=s,this.configurationService=c,this.resource=t,this.name=r,this.description=n}return o(t,e),t.prototype.getLabel=function(){return this.name},t.prototype.getAriaLabel=function(){return c.localize(0,null,this.getLabel())},t.prototype.getDescription=function(){return this.description},t.prototype.getIcon=function(){return this.icon},t.prototype.getResource=function(){return this.resource},t.prototype.setRange=function(e){this.range=e},t.prototype.isFile=function(){return!0},t.prototype.getInput=function(){var e={resource:this.resource,options:{pinned:!this.configurationService.getConfiguration().workbench.editor.enablePreviewFromQuickOpen}};return this.range&&(e.options.selection=this.range),e},t=r([n(4,y.IWorkbenchEditorService),n(5,S.IInstantiationService),n(6,g.IConfigurationService),n(7,k.IWorkspaceContextService)],t)}(d.EditorQuickOpenEntry);t.FileEntry=L;var _=function(e){function t(t,r,n,o){e.call(this),this.editorGroupService=t,this.instantiationService=r,this.contextService=n,this.searchService=o,this.queryBuilder=this.instantiationService.createInstance(f.QueryBuilder)}return o(t,e),t.prototype.setOptions=function(e){this.options=e},t.prototype.getResults=function(e,t){return e=e.trim(),e?this.doFindResults(e,this.cacheState.cacheKey,t):i.TPromise.as(new R([]))},t.prototype.doFindResults=function(e,t,r){var n=this,o={folderResources:this.contextService.getWorkspace()?[this.contextService.getWorkspace().resource]:[],extraFileResources:m.getOutOfWorkspaceEditorResources(this.editorGroupService,this.contextService),filePattern:e,cacheKey:t};return"number"==typeof r&&(o.maxResults=r,o.sortByScore=!0),this.searchService.search(this.queryBuilder.file(o)).then(function(e){for(var t=[],r=0;r<e.results.length;r++){var o=e.results[r],i=a.basename(o.resource.fsPath),s=u.getPathLabel(a.dirname(o.resource.fsPath),n.contextService);t.push(n.instantiationService.createInstance(L,o.resource,i,s,n.options&&n.options.useIcons?"file":null))}return new R(t,e.stats)})},t.prototype.hasShortResponseTime=function(){return this.isCacheLoaded},t.prototype.onOpen=function(){var e=this;this.cacheState=new E(function(t){return e.cacheQuery(t)},function(t){return e.searchService.search(t)},function(t){return e.searchService.clearCache(t)},this.cacheState),this.cacheState.load()},t.prototype.cacheQuery=function(e){var t={folderResources:this.contextService.getWorkspace()?[this.contextService.getWorkspace().resource]:[],extraFileResources:m.getOutOfWorkspaceEditorResources(this.editorGroupService,this.contextService),filePattern:"",cacheKey:e,maxResults:0,sortByScore:!0},r=this.queryBuilder.file(t);return this.searchService.extendQuery(r),r},Object.defineProperty(t.prototype,"isCacheLoaded",{get:function(){return this.cacheState&&this.cacheState.isLoaded},enumerable:!0,configurable:!0}),t.prototype.getGroupLabel=function(){return c.localize(1,null)},t.prototype.getAutoFocus=function(e){return{autoFocusFirstEntry:!0}},t=r([n(0,v.IEditorGroupService),n(1,S.IInstantiationService),n(2,k.IWorkspaceContextService),n(3,b.ISearchService)],t)}(d.QuickOpenHandler);t.OpenFileHandler=_;var E=function(){function e(e,t,r,n){if(this.cacheQuery=e,this.doLoad=t,this.doDispose=r,this.previous=n,this._cacheKey=h.generateUuid(),this._isLoaded=!1,this.query=e(this._cacheKey),this.previous){var o=l.assign({},this.query,{cacheKey:null}),i=l.assign({},this.previous.query,{cacheKey:null});l.equals(o,i)||(this.previous.dispose(),this.previous=null)}}return Object.defineProperty(e.prototype,"cacheKey",{get:function(){return this._isLoaded||!this.previous?this._cacheKey:this.previous.cacheKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return this._isLoaded||!this.previous?this._isLoaded:this.previous.isLoaded},enumerable:!0,configurable:!0}),e.prototype.load=function(){var e=this;this.promise=this.doLoad(this.query).then(function(){e._isLoaded=!0,e.previous&&(e.previous.dispose(),e.previous=null)},function(e){s.onUnexpectedError(e)})},e.prototype.dispose=function(){var e=this;this.promise.then(null,function(){}).then(function(){return e._isLoaded=!1,e.doDispose(e._cacheKey)}).then(null,function(e){s.onUnexpectedError(e)}),this.previous&&(this.previous.dispose(),this.previous=null)},e}()}),define(e[18],t([0,1,11,6,12,15,3,7,25,26,14,20,9,8,2,27]),function(e,t,i,s,c,a,u,l,h,p,d,f,m,v,y,g){"use strict";var S=function(e){function t(t,r,n,o,i){e.call(this,i),this._bearing=t,this._provider=r,this._configurationService=n,this._contextService=o}return o(t,e),t.prototype.getLabel=function(){return this._bearing.name},t.prototype.getAriaLabel=function(){return i.localize(0,null,this.getLabel())},t.prototype.getDescription=function(){var e=this._bearing.containerName;return!e&&this._bearing.resource&&(e=d.getPathLabel(this._bearing.resource,this._contextService)),e},t.prototype.getIcon=function(){return this._bearing.type},t.prototype.getResource=function(){return this._bearing.resource},t.prototype.run=function(t,r){var n=this;return this._bearingResolve||"function"!=typeof this._provider.resolveWorkspaceSymbol||this._bearing.range||(this._bearingResolve=this._provider.resolveWorkspaceSymbol(this._bearing).then(function(e){return n._bearing=e||n._bearing,n},c.onUnexpectedError)),s.TPromise.as(this._bearingResolve).then(function(o){return e.prototype.run.call(n,t,r)}).done(void 0,c.onUnexpectedError),!0},t.prototype.getInput=function(){var e={resource:this._bearing.resource,options:{pinned:!this._configurationService.getConfiguration().workbench.editor.enablePreviewFromQuickOpen}};return this._bearing.range&&(e.options.selection=p.Range.collapseToStart(this._bearing.range)),e},t.compare=function(e,t,r){var n=e.getLabel().toLowerCase(),o=t.getLabel().toLowerCase();if(n===o){var i=e._bearing.type,s=t._bearing.type;return i.localeCompare(s)}return l.QuickOpenEntry.compare(e,t,r)},t=r([n(2,y.IConfigurationService),n(3,v.IWorkspaceContextService),n(4,f.IWorkbenchEditorService)],t)}(u.EditorQuickOpenEntry),b=function(e){function t(r){e.call(this),this.instantiationService=r,this.delayer=new a.ThrottledDelayer(t.SEARCH_DELAY),this.options=Object.create(null)}return o(t,e),t.prototype.setOptions=function(e){this.options=e},t.prototype.canRun=function(){return!0},t.prototype.getResults=function(e){var t=this;if(e=e.trim(),!e)return s.TPromise.as(new l.QuickOpenModel([]));var r;return r=this.options.skipDelay?this.doGetResults(e):this.delayer.trigger(function(){return t.doGetResults(e)}),r.then(function(e){return new l.QuickOpenModel(e)})},t.prototype.doGetResults=function(e){var t=this;return g.getWorkspaceSymbols(e).then(function(r){for(var n=[],o=0,i=r;o<i.length;o++){var s=i[o],c=s[0],a=s[1];t.fillInSymbolEntries(n,c,a,e)}return t.options.skipSorting?n:(e=e.toLowerCase(),n.sort(function(t,r){return S.compare(t,r,e)}))})},t.prototype.fillInSymbolEntries=function(e,t,r,n){for(var o=0,i=r;o<i.length;o++){var s=i[o];if(!this.options.skipLocalSymbols||!s.containerName){var c=this.instantiationService.createInstance(S,s,t);c.setHighlights(h.matchesFuzzy(n,c.getLabel())),e.push(c)}}},t.prototype.getGroupLabel=function(){return i.localize(1,null)},t.prototype.getEmptyLabel=function(e){return e.length>0?i.localize(2,null):i.localize(3,null)},t.prototype.getAutoFocus=function(e){return{autoFocusFirstEntry:!0,autoFocusPrefixMatch:e.trim()}},t.SEARCH_DELAY=500,t=r([n(0,m.IInstantiationService)],t)}(u.QuickOpenHandler);t.OpenSymbolHandler=b}),define(e[22],t([0,1,29,5,6,4,15,30,31,13,32,7,3,10,18,33,9,34,8,2]),function(e,t,i,s,c,a,u,l,h,p,d,f,m,v,y,g,S,b,k,R){"use strict";var L=s.assign;t.OpenSymbolHandler=y.OpenSymbolHandler;var _=function(e){function s(r,n,o,i,c){e.call(this),this.messageService=r,this.contextService=n,this.configurationService=i,this.telemetryService=c,this.scorerCache=Object.create(null),this.searchDelayer=new u.ThrottledDelayer(s.FILE_SEARCH_DELAY),this.openSymbolHandler=o.createInstance(t.OpenSymbolHandler),this.openFileHandler=o.createInstance(v.OpenFileHandler),this.updateHandlers(this.configurationService.getConfiguration()),this.registerListeners()}return o(s,e),s.prototype.registerListeners=function(){var e=this;this.configurationService.onDidUpdateConfiguration(function(t){return e.updateHandlers(t.config)})},s.prototype.updateHandlers=function(e){this.includeSymbols=e&&e.search&&e.search.quickOpen&&e.search.quickOpen.includeSymbols,this.openFileHandler.setOptions({useIcons:this.includeSymbols}),this.openSymbolHandler.setOptions({skipDelay:!0,skipLocalSymbols:!0,skipSorting:!0})},s.prototype.getResults=function(e){var t=this,r=this.telemetryService.timedPublicLog("openAnything"),n=r.startTime?r.startTime.getTime():Date.now();this.cancelPendingSearch(),this.isClosed=!1,e=e.replace(/ /g,""),h.isWindows&&(e=e.replace(/\//g,"\\"));var o=this.extractRange(e);if(o&&(e=o.search),!e)return c.TPromise.as(new f.QuickOpenModel);var a=function(){var a=[];return a.push(t.openFileHandler.getResults(e,s.MAX_DISPLAYED_RESULTS)),!t.includeSymbols||o||p.isAbsolute(e)?a.push(c.TPromise.as(new f.QuickOpenModel)):a.push(t.openSymbolHandler.getResults(e)),t.pendingSearch=c.TPromise.join(a).then(function(a){if(t.pendingSearch=null,t.isClosed)return c.TPromise.as(new f.QuickOpenModel);var u=a[0].entries.concat(a[1].entries),l=Date.now(),h=d.stripWildcards(e).toLowerCase(),p=function(r,n){return f.QuickOpenEntry.compareByScore(r,n,e,h,t.scorerCache)},m=i.top(u,p,s.MAX_DISPLAYED_RESULTS),y=Date.now();m.forEach(function(t){if(t instanceof v.FileEntry){t.setRange(o?o.range:null);var r=f.QuickOpenEntry.highlight(t,e,!0),n=r.labelHighlights,i=r.descriptionHighlights;t.setHighlights(n,i)}});var g;return a[0]instanceof v.FileQuickOpenModel?g=a[0].stats:a[1]instanceof v.FileQuickOpenModel&&(g=a[1].stats),r.data=t.createTimerEventData(n,{searchLength:e.length,unsortedResultTime:l,sortedResultTime:y,resultCount:u.length,symbols:{fromCache:!1},files:g}),r.stop(),c.TPromise.as(new f.QuickOpenModel(m))},function(e){t.pendingSearch=null,t.messageService.show(g.Severity.Error,e)}),t.pendingSearch};return this.hasShortResponseTime()?a():this.searchDelayer.trigger(a,this.includeSymbols?s.SYMBOL_SEARCH_DELAY:s.FILE_SEARCH_DELAY)},s.prototype.hasShortResponseTime=function(){return this.includeSymbols?this.openFileHandler.hasShortResponseTime()&&this.openSymbolHandler.hasShortResponseTime():this.openFileHandler.hasShortResponseTime()},s.prototype.extractRange=function(e){if(!e)return null;var t=null,r=s.LINE_COLON_PATTERN.exec(e);if(r&&r.length>1){var n=parseInt(r[1],10);if(l.isNumber(n)){if(t={startLineNumber:n,startColumn:1,endLineNumber:n,endColumn:1},r.length>3){var o=parseInt(r[3],10);l.isNumber(o)&&(t.startColumn=o,t.endColumn=o)}}else""===r[1]&&(t={startLineNumber:1,startColumn:1,endLineNumber:1,endColumn:1})}return t?{search:e.substr(0,r.index),range:t}:null},s.prototype.getGroupLabel=function(){return this.includeSymbols?a.localize(0,null):a.localize(1,null)},s.prototype.getAutoFocus=function(e){return{autoFocusFirstEntry:!0}},s.prototype.onOpen=function(){this.openSymbolHandler.onOpen(),this.openFileHandler.onOpen()},s.prototype.onClose=function(e){this.isClosed=!0,this.cancelPendingSearch(),this.scorerCache=Object.create(null),this.openSymbolHandler.onClose(e),this.openFileHandler.onClose(e)},s.prototype.cancelPendingSearch=function(){this.pendingSearch&&(this.pendingSearch.cancel(),this.pendingSearch=null)},s.prototype.createTimerEventData=function(e,t){return{searchLength:t.searchLength,unsortedResultDuration:t.unsortedResultTime-e,sortedResultDuration:t.sortedResultTime-e,resultCount:t.resultCount,symbols:t.symbols,files:this.createFileEventData(e,t.files)}},s.prototype.createFileEventData=function(e,t){var r=t,n=t;return L({fromCache:t.fromCache,unsortedResultDuration:t.unsortedResultTime&&t.unsortedResultTime-e,sortedResultDuration:t.sortedResultTime&&t.sortedResultTime-e,resultCount:t.resultCount},t.fromCache?{cacheLookupStartDuration:r.cacheLookupStartTime-e,cacheFilterStartDuration:r.cacheFilterStartTime-e,cacheLookupResultDuration:r.cacheLookupResultTime-e,cacheEntryCount:r.cacheEntryCount,joined:r.joined&&this.createFileEventData(e,r.joined)}:{traversal:n.traversal,errors:n.errors,fileWalkStartDuration:n.fileWalkStartTime-e,fileWalkResultDuration:n.fileWalkResultTime-e,directoriesWalked:n.directoriesWalked,filesWalked:n.filesWalked,cmdForkStartDuration:n.cmdForkStartTime&&n.cmdForkStartTime-e,cmdForkResultDuration:n.cmdForkResultTime&&n.cmdForkResultTime-e,cmdResultCount:n.cmdResultCount})},s.LINE_COLON_PATTERN=/[#|:|\(](\d*)([#|:|,](\d*))?\)?$/,s.FILE_SEARCH_DELAY=300,s.SYMBOL_SEARCH_DELAY=500,s.MAX_DISPLAYED_RESULTS=512,s=r([n(0,g.IMessageService),n(1,k.IWorkspaceContextService),n(2,S.IInstantiationService),n(3,R.IConfigurationService),n(4,b.ITelemetryService)],s)}(m.QuickOpenHandler);t.OpenAnythingHandler=_})}).call(this);
//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/66f37fd2a99eb9d628dd374d81d78835b410c39b/vs\workbench\parts\search\browser\openAnythingHandler.js.map
